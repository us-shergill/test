for (let retroNum = 1; retroNum < mailOrderCol; ++retroNum) {
    // Grab the address of the current "working cell"
    let pharmAddress = (worksheet.getRow(rowNum).getCell((colNum - retroNum))._address).toString();

    // Get the value safely
    let cellValue = worksheet.getCell(pharmAddress).value;

    if (cellValue && typeof cellValue === "string") {
        var pharmText = cellValue.substring(0, 100); // Extract only if it's a string
        var pharmValue: number = +pharmText; // Convert to number
    } else {
        console.warn(`Null or invalid cell value at ${pharmAddress}`);
        var pharmValue: number = 0; // Default or handle appropriately
    }
}
